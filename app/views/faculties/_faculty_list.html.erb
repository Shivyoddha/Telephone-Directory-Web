<style media="screen">
  .department-heading {
    background-color: #f8f9fa;
    border: 1px solid #d1d1d1;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 5px;
    text-align: center;
  }

  .department-title {
    font-size: 20px;
    background-color: #198754;
    color: #fff;
    padding: 6px;
    border-radius: 5px;
  }

  .firstend{
    border-top-left-radius: 5px;
    border-bottom-left-radius: 5px;

  }

  .lastend{
    border-top-right-radius: 5px;
    border-bottom-right-radius: 5px;
  }

  .table th {
    text-align: center;
    vertical-align: middle;
    border: 1px solid #eee;
  }

  .table td {
    text-align: center;
    vertical-align: middle;
    border: 1px solid #e6e6e6;
    padding:1px;
  }

  .table th {
    background-color: rgba(25,46,89,255);
    color: #fff;
    text-align: center;
    font-size: 0.2;
  }

  .table tbody tr:nth-child(odd) {
    background-color: #eee;
  }

  .modal-body dl dd {
    word-wrap: break-word;
  }


  .row-item {
    display: flex;
    flex-direction: row;
  }

  .section-title {
     margin-bottom: 40px;
   }

   .team .member {
     padding: 40px;
   }

   .table {
    margin-bottom: 40px;
    border-spacing: 10px 20px;
  }

  .details-btn {
     --bs-btn-line-height: 1;
     --bs-btn-font-size: 0.75rem;
     background-color: #192f59;
     color: #fff;
     margin: 2px;
  }

  .details-btn:hover {
    background-color: #192f59;
    color: #fff;
  }

  .unselectable {
    user-select: none;
  }

</style>
<div class="container-fluid">
  <table class="table">
    <thead>
      <tr>
        <th class="firstend"> Sl. No. </th>
        <th style="text-align: ;"> Name </th>
        <th > Designation </th>
        <th > Contact </th>
        <th class="lastend"> Details </th>
      </tr>
    </thead>
    <tbody>
      <% @departments.each do |department| %>
        <% faculties_for_department = @faculties_by_department[department.name] %>
        <% if faculties_for_department.present? %>
          <tr>
            <td colspan="5" class="department-heading" style="text-align: center;">
              <div class="department-title" style="font-weight: 500;"><%= department.name %></div>
            </td>
          </tr>
          <% faculties_for_department.each_with_index do |faculty, index| %>
            <tr>
              <td style="width:2%; "> <%= index + 1 %> </td>
              <td style="width:5%; text-align: left;"> <%= faculty.name %> </td>

              <td style="width:8%;"> <%= faculty.designation.title %> </td>
              <td style="width:3%;" class="unselectable"> <%= faculty.landline_office_intercom %> </td>
              <td style="width:2%; text-align: center;">
                <!-- Button to trigger Bootstrap modal -->
                <button type="button" class="btn details-btn" data-bs-toggle="modal" data-bs-target="#facultyModal" data-id="<%= faculty.id %>">
                  Click here
                </button>
              </td>
            </tr>
          <% end %>
        <% end %>
      <% end %>
    </tbody>
  </table>
</div>


<!-- Modal -->
<div class="modal fade" id="facultyModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="container">
          <div class="row" id="faculty-details">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <!-- Close button for the modal -->
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>



<script>
document.addEventListener('DOMContentLoaded', () => {
  $('#facultyModal').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget);
    var facultyId = button.data('id');

    var modal = $(this);
    $.ajax({
      url: '/faculties/' + facultyId,
      method: 'GET',
      success: function(data) {
        modal.find('#faculty-details').html(data);
      },
      error: function() {
        modal.find('#faculty-details').html('<p>Error loading faculty details</p>');
      }
    });
  });
});
</script>